<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archive</title>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-white min-h-screen">
    <!-- Thin black banner with right-aligned buttons -->
    <header class="bg-black text-white" style="height:42px;">
        <div class="max-w-7xl mx-auto h-full flex items-center justify-between">
            <div class="flex items-center h-full">
                <a href="/" class="h-full flex items-center px-6 bg-white text-black font-semibold">ARCHIVE</a>
            </div>
            <div class="flex items-center h-full">
                <a href="/register" class="h-full flex items-center px-6 bg-white text-black font-semibold">REGISTER</a>
                <a href="/signin" class="h-full flex items-center px-6 bg-white text-black font-semibold border-l border-black">ACCOUNT</a>
            </div>
        </div>
    </header>

    <!-- Landing area with photo tiles - fills viewport below header -->
    <main id="tiles-container" class="w-full overflow-y-auto" style="height: calc(100vh - 42px);">
        <div id="tiles" class="w-full grid gap-0" style="grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));">
            <style>
                #tiles > div {
                    aspect-ratio: 1 / 1;
                    width: 100%;
                }
            </style>
            <!-- tiles will be generated by JS to exactly fill the available grid (rows x cols) -->
        </div>
    </main>

    <!-- Floating Contact Button -->
    <a href="/contact" class="fixed bottom-0 right-0 bg-black text-white px-6 py-3 hover:bg-gray-800 transition-colors z-50">
        CONTACT
    </a>

    <script>
        (function() {
            const container = document.getElementById('tiles');

            function computeAndFill() {
                // Clear existing tiles
                container.innerHTML = '';

                const containerRect = container.getBoundingClientRect();
                const headerHeight = document.querySelector('header').getBoundingClientRect().height || 42;
                const availableHeight = window.innerHeight - headerHeight;

                // Read computed columns from CSS grid
                const style = getComputedStyle(container);
                const cols = style.gridTemplateColumns.split(' ').length;

                // Tile width is container width / cols
                const tileWidth = containerRect.width / cols;
                // Number of rows needed to fill vertically, plus two extra rows for scrolling
                const rows = Math.ceil(availableHeight / tileWidth) + 2;

                const total = rows * cols;

                for (let i = 0; i < total; i++) {
                    let tile;
                    if (i === 0) {
                        // Greensleeves Sampler tile
                        tile = document.createElement('div');
                        tile.className = 'group relative overflow-hidden';
                        tile.style.backgroundColor = '#222';
                        tile.style.aspectRatio = '1 / 1';
                        tile.style.display = 'flex';
                        tile.style.alignItems = 'center';
                        tile.style.justifyContent = 'center';

                        // Album image
                        const img = document.createElement('img');
                        img.src = 'https://img.discogs.com/1QwQvQwQvQwQvQwQvQwQvQwQvQw=/fit-in/600x600/filters:strip_icc():format(jpeg):mode_rgb():quality(90)/discogs-images/R-7549711-1463402822-5637.jpeg.jpg';
                        img.alt = 'Greensleeves Sampler';
                        img.style.width = '100%';
                        img.style.height = '100%';
                        img.style.objectFit = 'cover';
                        tile.appendChild(img);

                        const overlay = document.createElement('div');
                        overlay.className = 'absolute inset-0';
                        overlay.style.background = 'rgba(0,0,0,0)';
                        overlay.style.transition = 'background 200ms';
                        tile.appendChild(overlay);

                        const content = document.createElement('div');
                        content.className = 'absolute inset-0 flex flex-col items-center justify-center';
                        content.style.opacity = '0';
                        content.style.transition = 'opacity 200ms';
                        content.style.color = 'white';

                        const title = document.createElement('div');
                        title.textContent = 'Various â€“ Greensleeves Sampler';
                        title.style.fontWeight = '700';
                        title.style.fontSize = '1rem';
                        content.appendChild(title);

                        const btn = document.createElement('a');
                        btn.textContent = 'INFO';
                        btn.href = 'https://www.discogs.com/release/7549711-Various-Greensleeves-Sampler';
                        btn.target = '_blank';
                        btn.style.marginTop = '8px';
                        btn.className = 'bg-white text-black px-3 py-1 rounded';
                        content.appendChild(btn);

                        tile.appendChild(content);

                        tile.addEventListener('mouseenter', () => {
                            overlay.style.background = 'rgba(0,0,0,0.5)';
                            content.style.opacity = '1';
                        });
                        tile.addEventListener('mouseleave', () => {
                            overlay.style.background = 'rgba(0,0,0,0)';
                            content.style.opacity = '0';
                        });

                        container.appendChild(tile);
                    } else {
                        const shade = ["#ffffff","#f8f8f8","#e5e5e5","#bfbfbf","#808080","#404040","#000000"][i % 7];
                        tile = document.createElement('div');
                        tile.className = 'group relative overflow-hidden';
                        tile.style.backgroundColor = shade;
                        tile.style.aspectRatio = '1 / 1';
                        tile.style.display = 'flex';
                        tile.style.alignItems = 'center';
                        tile.style.justifyContent = 'center';

                        const overlay = document.createElement('div');
                        overlay.className = 'absolute inset-0';
                        overlay.style.background = 'rgba(0,0,0,0)';
                        overlay.style.transition = 'background 200ms';
                        tile.appendChild(overlay);

                        const content = document.createElement('div');
                        content.className = 'absolute inset-0 flex flex-col items-center justify-center';
                        content.style.opacity = '0';
                        content.style.transition = 'opacity 200ms';
                        content.style.color = 'white';

                        const title = document.createElement('div');
                        title.textContent = 'RECORD';
                        title.style.fontWeight = '700';
                        title.style.fontSize = '1rem';
                        content.appendChild(title);

                        const btn = document.createElement('button');
                        btn.textContent = 'INFO';
                        btn.style.marginTop = '8px';
                        btn.className = 'bg-white text-black px-3 py-1 rounded';
                        content.appendChild(btn);

                        tile.appendChild(content);

                        tile.addEventListener('mouseenter', () => {
                            overlay.style.background = 'rgba(0,0,0,0.5)';
                            content.style.opacity = '1';
                        });
                        tile.addEventListener('mouseleave', () => {
                            overlay.style.background = 'rgba(0,0,0,0)';
                            content.style.opacity = '0';
                        });

                        container.appendChild(tile);
                    }
                }
            }

            // Recompute on load and resize
            window.addEventListener('load', computeAndFill);
            window.addEventListener('resize', () => {
                // debounce
                clearTimeout(window.__tileResize);
                window.__tileResize = setTimeout(computeAndFill, 120);
            });
        })();
    </script>
</body>
</html>